{% extends 'base.html' %}
{% block content %}
<div>
    <h2>{{ blog.title }}</h2>
    <h4>By {{ blog.user }}</h4>
    <p>{{ blog.content|safe }}</p>

    {% if user.id == blog.user.id %}
        <div>
            <a href="edit" class="btn btn-warning btn-sm">Edit</a>
            <a href="delete" class="btn btn-danger btn-sm">Delete</a>
        </div>
    {% endif %}

    <h4>Comments</h4>

    {% if not blog.comments.all %}
        <p>No Comments Yet</p>
    {% else %}
        <div>
            {% for comment in blog.comments.all %}
                <div>{{ comment.comment}}</div>
                <p>{{ comment.user }} - {{ comment.created_at }}</p>
                {% if user.is_authenticated %}
                    {% if user.id == comment.user.id %}    
                        <a href="delete_comment/{{ comment.id }}" class="btn btn-danger btn-sm">Delete</a>
                    {% endif %}
                {% endif %}
            {% endfor %}
        </div>
    {% endif %}

    <h4>Add Comment</h4>

    {% if user.is_authenticated %}
        <form method="POST">
            {{ comment_form.as_p }}
            {% csrf_token%}
            <!-- <label for="comment">  </label>
            <input id="comment" type="text" name="comment"> -->
            <button type="submit" class="btn btn-success">Add Comment</button>
        </form>
    
        <script>
            let name = "{{ user.id }}"
            document.getElementById("user").value = name;
        </script>
    {% endif %}
</div>


{% endblock %}